<?xml version="1.0" encoding="UTF-8"?>
<mxfile host="app.diagrams.net" modified="2025-01-05T12:00:00.000Z" agent="5.0" version="24.7.17" etag="" type="device">
  <diagram id="age-df-merge-flow" name="Age DF Merge Section Flow">
    <mxGraphModel dx="1422" dy="1199" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="1169" pageHeight="1427" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        
        <mxCell id="title" value="Age DF Merge Section Flow" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;fontSize=18;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="20" width="300" height="30" as="geometry" />
        </mxCell>
        
        <mxCell id="start" value="START&#xa;Age Prediction Methods&#xa;Merge &amp; Validation" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="480" y="70" width="140" height="60" as="geometry" />
        </mxCell>
        
        <mxCell id="validate_datasets" value="Validate Required Datasets&#xa;Check existence and structure:&#xa;• age_adjusted_predictions&#xa;• pct_adjusted_predictions&#xa;• men_pred_data&#xa;• Verify required columns present&#xa;• Assess data completeness" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="440" y="160" width="220" height="110" as="geometry" />
        </mxCell>
        
        <mxCell id="check_duplicates" value="Identify Duplicate Skiers&#xa;• Cross-dataset skier validation&#xa;• Identify overlapping athletes&#xa;• Check for naming inconsistencies&#xa;• Issue warnings for data quality issues&#xa;• Report duplicate statistics" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="440" y="300" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="primary_merge" value="Primary Data Merge&#xa;Base: age_adjusted_predictions&#xa;• First join: with pct_adjusted_predictions&#xa;• Second join: with men_pred_data&#xa;• Use left_join on Skier column&#xa;• Preserve all base dataset records" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="420" y="430" width="260" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="column_renaming" value="Column Renaming for Clarity&#xa;Standardize prediction columns:&#xa;• Predicted_Pelo_2026 → ELO_Method_2026&#xa;• Predicted_Pelo_2026_Pct → Percentage_Method_2026&#xa;• Predicted_Pct_2026 → GAM_Method_2026&#xa;• Ensure naming consistency" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="420" y="560" width="260" height="110" as="geometry" />
        </mxCell>
        
        <mxCell id="consensus_calculation" value="Calculate Consensus Predictions&#xa;• Average of ELO and Percentage methods&#xa;• Handle missing values gracefully&#xa;• Validate calculation results&#xa;• Create robust consensus metric&#xa;• Safe division operations" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="440" y="700" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="percentage_scaling" value="Normalize to Percentage Scale&#xa;• Scale all methods to comparable percentages&#xa;• Ensure consistent value ranges&#xa;• Handle different scaling approaches&#xa;• Validate normalization success&#xa;• Prevent scaling errors" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry x="440" y="830" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="age_effect_categorization" value="Age Effect Categorization&#xa;Create Age_Effect_Strength categories:&#xa;• ≤23: Strong Positive&#xa;• 24-27: Moderate Positive&#xa;• 28-31: Neutral&#xa;• 32-35: Moderate Negative&#xa;• >35: Strong Negative" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="420" y="960" width="260" height="110" as="geometry" />
        </mxCell>
        
        <mxCell id="sort_results" value="Sort &amp; Rank Results&#xa;• Sort by consensus percentage (descending)&#xa;• Rank athletes by predicted performance&#xa;• Validate sorting logic&#xa;• Handle tie-breaking scenarios&#xa;• Prepare for display" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#e1d5e7;strokeColor=#9673a6;" vertex="1" parent="1">
          <mxGeometry x="440" y="1100" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="display_top20" value="Display Top 20 Predictions&#xa;• Show all prediction methods side-by-side&#xa;• Include consensus predictions&#xa;• Display age effects and categories&#xa;• Format for readability&#xa;• Highlight key insights" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="440" y="1230" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="age_category_summary" value="Age Category Summary Statistics&#xa;• Aggregate results by age groups&#xa;• Calculate mean predictions per category&#xa;• Compare method performance by age&#xa;• Generate statistical insights&#xa;• Validate summary calculations" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="440" y="1360" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="store_final_results" value="Store Final Results&#xa;• Save as final_age_adjusted_predictions&#xa;• Ensure data persistence&#xa;• Validate storage success&#xa;• Prepare for downstream analysis&#xa;• Global environment storage" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;" vertex="1" parent="1">
          <mxGeometry x="440" y="1490" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="error_handling" value="Comprehensive Error Handling&#xa;• tryCatch blocks throughout process&#xa;• Validation of merge operations&#xa;• Safe mathematical operations&#xa;• Warning messages for data issues&#xa;• Recovery mechanisms for failures" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#f8cecc;strokeColor=#b85450;" vertex="1" parent="1">
          <mxGeometry x="440" y="1620" width="220" height="100" as="geometry" />
        </mxCell>
        
        <mxCell id="success" value="✓ AGE PREDICTION METHODS MERGED&#xa;Three prediction approaches consolidated&#xa;Consensus predictions generated&#xa;Comprehensive comparative analysis&#xa;Ready for strategic decision making" style="ellipse;whiteSpace=wrap;html=1;fillColor=#d5e8d4;strokeColor=#82b366;fontStyle=1;" vertex="1" parent="1">
          <mxGeometry x="440" y="1750" width="180" height="120" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="start" target="validate_datasets">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="validate_datasets" target="check_duplicates">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="check_duplicates" target="primary_merge">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="primary_merge" target="column_renaming">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="column_renaming" target="consensus_calculation">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="consensus_calculation" target="percentage_scaling">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="percentage_scaling" target="age_effect_categorization">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow8" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="age_effect_categorization" target="sort_results">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="sort_results" target="display_top20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="display_top20" target="age_category_summary">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="age_category_summary" target="store_final_results">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="store_final_results" target="error_handling">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
        <mxCell id="arrow13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="error_handling" target="success">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
---
title: "2026 Cross-Country Season Preview"
author: "Syver Johansen"
date: "2025-01-05"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

## 2026 Cross-Country Season Preview

This preview analyzes the upcoming 2026 cross-country skiing season, including points predictions, Klaebo dominance scenarios, Russian return impact, and breakthrough potential candidates.

### Load Libraries

```{r load-packages, message=FALSE, warning=FALSE}
library(dplyr)
library(purrr)
library(tidyr)
library(readr)
library(ggplot2)
library(openxlsx)
library(moments)  # for skewness/kurtosis
```

### Load Data

```{r load-data}
# Load men's and ladies chrono data from CSV files
M_chrono <- read_csv('/Users/syverjohansen/ski/elo/python/ski/polars/excel365/men_chrono.csv')
L_chrono <- read_csv('/Users/syverjohansen/ski/elo/python/ski/polars/excel365/ladies_chrono.csv')

# World Cup points mapping
wc_points <- c(100,95,90,85,80,75,72,69,66,63,60,58,56,54,52,50,48,46,44,42,40,38,36,34,32,30,28,26,24,22,20,19,18,17,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1)
stage_points <- c(50,47,44,41,38,35,32,30,28,26,24,22,20,18,16,15,14,13,12,11,10,9,8,7,6,5,4,3,2,1)
tds_points <- c(300,285,270,255,240,216,207,198,189,180,174,168,162,156,150,144,138,132,126,120,114,108,102,96,90,84,78,72,66,60,57,54,51,48,45,42,39,36,33,30,27,24,21,18,15,12,9,6,3)

# Function to safely fetch points based on Place
get_points <- function(place, points_list) {
  if (place >= 1 && place <= length(points_list)) {
    return(points_list[place])
  }
  return(0)
}

print("Data loaded successfully!")
print(paste("Men's data:", nrow(M_chrono), "rows"))
print(paste("Ladies data:", nrow(L_chrono), "rows"))
```